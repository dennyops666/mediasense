# 后端测试用例

## 1. P0级测试用例（阻塞性问题）

### 1.1 认证核心服务测试用例

#### TC-AUTH-001: 用户登录流程
- **优先级**: P0
- **前置条件**: 
  - 系统中存在有效的用户账号
  - 数据库和缓存服务正常运行
- **测试步骤**:
  1. 使用正确的用户名和密码登录
  2. 使用错误的密码登录
  3. 使用不存在的用户名登录
  4. 使用已被封禁的账号登录
  5. 使用特殊字符的用户名登录
- **预期结果**:
  1. 登录成功，返回有效的JWT token
  2. 登录失败，返回密码错误提示
  3. 登录失败，返回用户不存在提示
  4. 登录失败，返回账号已封禁提示
  5. 系统正确处理特殊字符，不发生异常

#### TC-AUTH-002: JWT Token验证
- **优先级**: P0
- **前置条件**: 
  - 用户已成功登录
  - 系统持有有效的JWT token
- **测试步骤**:
  1. 使用有效token访问受保护接口
  2. 使用过期token访问接口
  3. 使用无效token访问接口
  4. 使用被加入黑名单的token访问
  5. 测试token刷新机制
- **预期结果**:
  1. 成功访问接口
  2. 返回token过期错误
  3. 返回无效token错误
  4. 拒绝访问，返回相应错误
  5. 成功刷新token

### 1.2 数据库服务测试用例

#### TC-DB-001: 数据库连接池
- **优先级**: P0
- **前置条件**:
  - MySQL服务正常运行
  - 连接池配置完成
- **测试步骤**:
  1. 测试连接池初始化
  2. 并发请求获取连接
  3. 测试连接超时处理
  4. 测试连接释放机制
  5. 测试连接池满载情况
- **预期结果**:
  1. 连接池正确初始化
  2. 并发请求正常处理
  3. 超时情况正确处理
  4. 连接正确释放回池
  5. 满载时请求正确排队

#### TC-DB-002: 数据库事务
- **优先级**: P0
- **前置条件**:
  - 数据库服务正常
  - 测试数据已准备
- **测试步骤**:
  1. 执行单表事务操作
  2. 执行多表事务操作
  3. 测试事务回滚
  4. 测试事务隔离级别
  5. 测试死锁处理
- **预期结果**:
  1. 单表事务正确提交或回滚
  2. 多表事务保持一致性
  3. 回滚操作正确执行
  4. 隔离级别正确生效
  5. 死锁被检测并处理

### 1.3 缓存服务测试用例

#### TC-CACHE-001: Redis连接管理
- **优先级**: P0
- **前置条件**:
  - Redis服务正常运行
  - 缓存配置完成
- **测试步骤**:
  1. 测试Redis连接建立
  2. 测试连接池管理
  3. 测试连接失败恢复
  4. 测试连接超时处理
  5. 测试哨兵模式切换
- **预期结果**:
  1. 连接正常建立
  2. 连接池正确管理连接
  3. 连接失败后自动恢复
  4. 超时情况正确处理
  5. 主从切换正常进行

#### TC-CACHE-002: 缓存策略
- **优先级**: P0
- **前置条件**:
  - 缓存服务正常运行
  - 测试数据已准备
- **测试步骤**:
  1. 测试缓存写入
  2. 测试缓存读取
  3. 测试缓存更新
  4. 测试缓存失效
  5. 测试缓存穿透防护
- **预期结果**:
  1. 数据正确写入缓存
  2. 缓存读取正确返回
  3. 缓存更新及时生效
  4. 过期缓存自动失效
  5. 穿透防护有效工作

## 2. P1级测试用例（核心功能）

### 2.1 新闻管理测试用例

#### TC-NEWS-001: 新闻CRUD操作
- **优先级**: P1
- **前置条件**:
  - 用户已登录
  - 具有相应权限
- **测试步骤**:
  1. 创建新闻文章
  2. 读取新闻详情
  3. 更新新闻内容
  4. 删除新闻文章
  5. 批量操作新闻
- **预期结果**:
  1. 新闻创建成功
  2. 正确显示新闻信息
  3. 更新内容正确保存
  4. 删除操作正确执行
  5. 批量操作正确完成

#### TC-NEWS-002: 新闻审核流程
- **优先级**: P1
- **前置条件**:
  - 存在待审核的新闻
  - 审核人员已登录
- **测试步骤**:
  1. 提交新闻审核
  2. 审核人员审查
  3. 修改后重新提交
  4. 审核通过发布
  5. 审核操作记录
- **预期结果**:
  1. 提交成功进入审核
  2. 审核意见正确记录
  3. 修改后重新进入审核
  4. 审核通过后正确发布
  5. 完整记录审核历史

### 2.2 搜索服务测试用例

#### TC-SEARCH-001: 全文搜索
- **优先级**: P1
- **前置条件**:
  - Elasticsearch服务正常
  - 索引数据已建立
- **测试步骤**:
  1. 基础关键词搜索
  2. 高级条件过滤
  3. 结果排序测试
  4. 分页功能测试
  5. 搜索性能测试
- **预期结果**:
  1. 准确返回搜索结果
  2. 过滤条件正确应用
  3. 排序规则正确执行
  4. 分页正确实现
  5. 性能满足要求

#### TC-SEARCH-002: 搜索建议
- **优先级**: P1
- **前置条件**:
  - 搜索服务正常运行
  - 有足够的历史数据
- **测试步骤**:
  1. 输入关键词提示
  2. 热门搜索推荐
  3. 历史搜索记录
  4. 实时搜索提示
  5. 个性化推荐
- **预期结果**:
  1. 正确提供搜索建议
  2. 准确显示热门搜索
  3. 正确显示历史记录
  4. 实时提示响应及时
  5. 推荐结果个性化

## 3. P2级测试用例（非核心功能）

### 3.1 AI服务测试用例

#### TC-AI-001: 文本分析
- **优先级**: P2
- **前置条件**:
  - AI服务正常运行
  - 模型已正确加载
- **测试步骤**:
  1. 情感分析测试
  2. 关键词提取
  3. 文本分类
  4. 摘要生成
  5. 批量处理
- **预期结果**:
  1. 情感分析结果准确
  2. 关键词提取合理
  3. 分类结果准确
  4. 摘要内容完整
  5. 批量处理正常

#### TC-AI-002: 分析任务管理
- **优先级**: P2
- **前置条件**:
  - 任务调度系统正常
  - 测试数据已准备
- **测试步骤**:
  1. 创建分析任务
  2. 任务调度执行
  3. 任务状态监控
  4. 结果通知推送
  5. 任务取消处理
- **预期结果**:
  1. 任务创建成功
  2. 调度正常执行
  3. 状态正确更新
  4. 通知正确发送
  5. 取消操作生效

### 3.2 爬虫服务测试用例

#### TC-CRAWLER-001: 爬虫配置管理
- **优先级**: P2
- **前置条件**:
  - 爬虫服务正常运行
  - 测试目标可访问
- **测试步骤**:
  1. 创建爬虫配置
  2. 测试URL规则
  3. 配置代理设置
  4. 设置采集规则
  5. 验证配置有效性
- **预期结果**:
  1. 配置创建成功
  2. URL规则正确匹配
  3. 代理设置生效
  4. 采集规则有效
  5. 配置验证通过

#### TC-CRAWLER-002: 数据采集
- **优先级**: P2
- **前置条件**:
  - 爬虫配置已完成
  - 目标网站可访问
- **测试步骤**:
  1. 启动采集任务
  2. 数据提取验证
  3. 错误处理测试
  4. 代理切换测试
  5. 数据存储验证
- **预期结果**:
  1. 任务正常启动
  2. 数据提取准确
  3. 错误正确处理
  4. 代理切换正常
  5. 数据正确存储

## 4. P3级测试用例（优化改进）

### 4.1 性能优化测试用例

#### TC-PERF-001: 缓存优化
- **优先级**: P3
- **前置条件**:
  - 系统正常运行
  - 监控工具就绪
- **测试步骤**:
  1. 测试缓存命中率
  2. 检查内存使用
  3. 验证过期策略
  4. 测试缓存预热
  5. 压力测试缓存
- **预期结果**:
  1. 命中率达标
  2. 内存使用合理
  3. 过期策略有效
  4. 预热功能正常
  5. 压力测试通过

#### TC-PERF-002: 数据库优化
- **优先级**: P3
- **前置条件**:
  - 数据库正常运行
  - 测试数据已准备
- **测试步骤**:
  1. 索引使用分析
  2. 慢查询优化
  3. 连接池调优
  4. 事务性能测试
  5. SQL执行计划
- **预期结果**:
  1. 索引使用合理
  2. 查询性能提升
  3. 连接池运行优化
  4. 事务执行高效
  5. 执行计划优化

### 4.2 监控日志测试用例

#### TC-MONITOR-001: 系统监控
- **优先级**: P3
- **前置条件**:
  - 监控系统已部署
  - 告警配置完成
- **测试步骤**:
  1. 资源使用监控
  2. 性能指标采集
  3. 告警规则测试
  4. 监控数据展示
  5. 历史数据查询
- **预期结果**:
  1. 资源监控准确
  2. 指标采集完整
  3. 告警规则生效
  4. 展示界面正常
  5. 查询功能正常

#### TC-MONITOR-002: 日志管理
- **优先级**: P3
- **前置条件**:
  - 日志系统已配置
  - 测试数据已生成
- **测试步骤**:
  1. 日志记录测试
  2. 日志分析查询
  3. 日志轮转测试
  4. 日志清理策略
  5. 审计日志验证
- **预期结果**:
  1. 日志记录完整
  2. 查询分析正常
  3. 轮转正确执行
  4. 清理策略生效
  5. 审计记录准确 