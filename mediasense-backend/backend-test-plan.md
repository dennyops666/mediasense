## P0级集成测试用例

### TC-INT-AUTH-001: 用户认证集成测试 ✅

#### 测试目标
验证用户认证系统的核心功能,包括登录、注册、权限控制等。

#### 测试步骤
1. 用户注册测试
   - 测试正常注册流程 ✅
   - 验证重复用户名/邮箱处理 ✅
   - 验证密码强度要求 ✅

2. 用户登录测试
   - 测试正常登录流程 ✅
   - 验证错误密码处理 ✅
   - 验证账户锁定机制 ✅

3. 权限控制测试
   - 验证角色权限分配 ✅
   - 测试资源访问控制 ✅
   - 验证权限继承关系 ✅

#### 预期结果
- 用户注册功能正常工作 ✅
- 登录认证机制安全可靠 ✅
- 权限控制准确有效 ✅

#### 相关代码
- `UserViewSet`: 用户管理接口 ✅
- `AuthService`: 认证服务实现 ✅
- `PermissionService`: 权限控制服务 ✅

### TC-INT-GATEWAY-001: API网关集成测试 ✅

#### 测试目标
验证API网关的核心功能，包括路由转发、认证、限流、负载均衡和服务发现。

#### 测试步骤
1. 路由转发测试
   - 验证新闻服务路由 ✅
   - 验证搜索服务路由 ✅
   - 验证AI服务路由 ✅

2. 认证集成测试
   - 验证无认证访问限制 ✅
   - 验证无效token处理 ✅
   - 验证过期token处理 ✅

3. 限流功能测试
   - 验证正常请求处理 ✅
   - 验证超过限制的请求处理 ✅

4. 负载均衡测试
   - 验证读操作使用从库 ✅
   - 验证写操作使用主库 ✅

5. 服务发现测试
   - 验证新闻服务发现 ✅
   - 验证搜索服务发现 ✅
   - 验证AI服务发现 ✅

#### 预期结果
- 所有服务路由正确转发 ✅
- 认证功能正常工作 ✅
- 限流功能按配置生效 ✅
- 读写分离正确路由 ✅
- 服务发现正常工作 ✅

#### 相关代码
- `APIGateway`: 网关服务实现 ✅
- `AuthMiddleware`: 认证中间件 ✅
- `RateLimitMiddleware`: 限流中间件 ✅
- `LoadBalancer`: 负载均衡器 ✅

### TC-INT-NEWS-001: 新闻管理和搜索集成测试 ✅

#### 测试目标
验证新闻管理和搜索功能的集成。

#### 测试步骤
1. 新闻管理测试
   - 测试文章创建和索引 ✅
   - 验证文章更新和缓存 ✅
   - 测试文章删除和清理 ✅

2. 搜索功能测试
   - 验证全文搜索 ✅
   - 测试分类筛选 ✅
   - 验证排序功能 ✅

#### 预期结果
- 新闻管理功能正常 ✅
- 搜索结果准确 ✅
- 缓存机制有效 ✅

#### 相关代码
- `NewsViewSet`: 新闻管理接口 ✅
- `SearchService`: 搜索服务 ✅
- `CacheService`: 缓存服务 ✅

## P1级集成测试用例

### TC-SEARCH-005: 搜索建议功能测试 ✅

#### 测试目标
验证系统能够根据用户输入的前缀提供相关的搜索建议。

#### 测试步骤
1. 准备测试数据
   - 创建多个带有特定标题和标签的测试新闻文章 ✅
   - 确保文章状态为已发布 ✅
   - 同步数据到 Elasticsearch ✅

2. 执行搜索建议请求
   - 使用特定前缀（如 'P'）请求搜索建议 ✅
   - 验证返回结果的状态码为 200 ✅
   - 验证返回的建议列表不为空 ✅
   - 验证建议标题包含搜索前缀 ✅
   - 验证建议按分数降序排序 ✅

#### 预期结果
- 系统返回与前缀匹配的建议列表 ✅
- 建议包含文章标题和相关标签 ✅
- 已发布文章的建议权重更高 ✅
- 建议结果按权重降序排序 ✅
- 建议结果去重且支持模糊匹配 ✅

#### 相关代码
- `NewsArticleDocument`: 定义文档结构和建议字段 ✅
- `NewsSearchService.suggest_titles()`: 处理搜索建议请求 ✅
- `NewsSearchViewSet.suggest()`: 提供搜索建议 API 接口 ✅

### TC-INT-AI-001: AI服务集成测试 ✅

#### 测试目标
验证AI服务的文本分析功能和与其他服务的集成。

#### 测试步骤
1. 文本分析测试
   - 测试情感分析功能 ✅
   - 验证关键词提取 ✅
   - 测试文本分类 ✅

2. 服务集成测试
   - 与新闻服务集成 ✅
   - 与监控服务集成 ✅
   - 验证异步任务处理 ✅

3. 错误处理测试
   - 测试超时处理 ✅
   - 验证重试机制 ✅
   - 测试降级策略 ✅

#### 预期结果
- 文本分析结果准确 ✅
- 服务间通信正常 ✅
- 错误处理机制有效 ✅

#### 相关代码
- `AIService`: AI服务实现 ✅
- `TextAnalyzer`: 文本分析器 ✅
- `AITaskManager`: 任务管理器 ✅

### TC-INT-CRAWLER-001: 爬虫与数据处理集成测试 ✅

#### 测试目标
验证爬虫系统的核心功能，包括任务执行、数据处理、错误处理和重复检测机制。

#### 测试步骤
1. 爬虫任务执行流程测试
   - 创建并验证爬虫配置 ✅
   - 执行测试任务并验证状态 ✅
   - 验证新闻文章创建结果 ✅

2. 数据处理流水线测试
   - 测试 API 数据源处理 ✅
   - 验证数据保存和转换 ✅
   - 检查处理结果统计 ✅

3. 错误处理和重试机制测试
   - 模拟任务执行失败 ✅
   - 验证重试计数和状态 ✅
   - 确认最终执行结果 ✅

4. 重复内容检测测试
   - 创建已存在的文章 ✅
   - 验证重复内容识别 ✅
   - 检查重复统计结果 ✅

#### 预期结果
- 爬虫任务能够正确创建和执行 ✅
- 数据处理流水线正确处理不同来源的数据 ✅
- 错误处理机制能够正确处理异常并支持重试 ✅
- 重复内容检测机制能够准确识别重复文章 ✅
- 任务执行状态和结果统计准确 ✅

#### 相关代码
- `CrawlerConfigViewSet`: 爬虫配置管理 ✅
- `CrawlerTaskViewSet`: 任务执行控制 ✅
- `crawl_single_website`: 异步任务处理 ✅
- `CrawlerService`: 数据处理服务 ✅

### TC-INT-MONITOR-001: 系统监控和告警集成测试 ❌

#### 测试目标
验证系统监控和告警功能的集成。

#### 测试步骤
1. 监控数据采集测试
   - 测试性能指标采集
   - 验证资源使用监控
   - 测试服务状态检查

2. 告警规则测试
   - 验证告警规则配置
   - 测试告警触发条件
   - 验证告警通知发送

#### 预期结果
- 监控数据采集正常
- 告警规则正确执行
- 通知发送及时准确

#### 相关代码
- `MonitoringService`: 监控服务
- `AlertManager`: 告警管理器
- `NotificationService`: 通知服务 